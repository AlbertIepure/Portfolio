<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">Fcomplexity</span>] = complexity(<span class="var type1" id="S3T6U6">I</span>,<span class="var type1" id="S4T1U7">d</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% d - the neighborhood size</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T1:U4"><span class="var type1" id="S5T1U10">W</span> = <span class="mxinfo " id="T1:U6">(<span class="mxinfo " id="T1:U7"><span class="mxinfo " id="T1:U8"><span class="mxinfo " id="T1:U9">2</span>*<span class="var type1" id="S4T1U16">d</span></span>+<span class="mxinfo " id="T1:U11">1</span></span>).^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T1:U12">[<span class="var type1" id="S6T1U22">h</span>,<span class="var type1" id="S7T1U23">w</span>] = size(<span class="var type1" id="S3T6U26">I</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T6:U16"><span class="var type1" id="S9T6U29">A_i</span> = <span class="mxinfo " id="T6:U18">zeros(<span class="var type1" id="S6T1U32">h</span>,<span class="var type1" id="S7T1U33">w</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T1:U21"><span class="var type1" id="S11T1U36">n_squared</span> = <span class="mxinfo " id="T1:U23">(<span class="mxinfo " id="T1:U24"><span class="var type1" id="S6T1U40">h</span>-<span class="mxinfo " id="T1:U26"><span class="mxinfo " id="T1:U27">2</span>*<span class="var type1" id="S4T1U43">d</span></span></span>)*(<span class="mxinfo " id="T1:U29"><span class="var type1" id="S7T1U46">w</span>-<span class="mxinfo " id="T1:U31"><span class="mxinfo " id="T1:U32">2</span>*<span class="var type1" id="S4T1U49">d</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo " id="T1:U34"><span class="var type1" id="S12T1U52">max_value</span> = double(<span class="mxinfo " id="T1:U36">max(<span class="mxinfo " id="T9:U37">max(<span class="mxinfo " id="T6:U38"><span class="var type1" id="S3T6U60">I</span>(<span class="mxinfo " id="T14:U40"><span class="mxinfo " id="T1:U41"><span class="var type1" id="S4T1U63">d</span>+<span class="mxinfo " id="T1:U43">1</span></span>:<span class="mxinfo " id="T1:U44"><span class="var type1" id="S6T1U66">h</span>-<span class="var type1" id="S4T1U67">d</span></span></span>,<span class="mxinfo " id="T14:U47"><span class="mxinfo " id="T1:U48"><span class="var type1" id="S4T1U70">d</span>+<span class="mxinfo " id="T1:U50">1</span></span>:<span class="mxinfo " id="T1:U51"><span class="var type1" id="S7T1U73">w</span>-<span class="var type1" id="S4T1U74">d</span></span></span>)</span>)</span>)</span>)</span>; <span class="comment">% within the region of interest</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T26:U54"><span class="var type1" id="S15T26U77">s_i</span> = <span class="mxinfo " id="T26:U56">zeros(<span class="mxinfo " id="T1:U57"><span class="var type1" id="S12T1U81">max_value</span>+<span class="mxinfo " id="T1:U59">1</span></span>,1)</span></span>; <span class="comment">% +1 because we assume that in the window we have all values from 0 onwards</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T26:U60"><span class="var type1" id="S16T26U86">p</span> = <span class="mxinfo " id="T26:U62">zeros(<span class="mxinfo " id="T1:U63"><span class="var type1" id="S12T1U90">max_value</span>+<span class="mxinfo " id="T1:U65">1</span></span>,1)</span></span>; <span class="comment">% probability of occurence of each gray-tone value</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S17T1U95">i</span>=<span class="mxinfo " id="T1:U67"><span class="var type1" id="S4T1U98">d</span>+<span class="mxinfo " id="T1:U69">1</span></span>:<span class="mxinfo " id="T1:U70"><span class="var type1" id="S6T1U101">h</span>-<span class="var type1" id="S4T1U102">d</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S18T1U105">j</span>=<span class="mxinfo " id="T1:U74"><span class="var type1" id="S4T1U108">d</span>+<span class="mxinfo " id="T1:U76">1</span></span>:<span class="mxinfo " id="T1:U77"><span class="var type1" id="S7T1U111">w</span>-<span class="var type1" id="S4T1U112">d</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">        <span class="mxinfo " id="T1:U80"><span class="mxinfo " id="T1:U81"><span class="var type1" id="S9T6U116">A_i</span>(<span class="var type1" id="S17T1U117">i</span>,<span class="var type1" id="S18T1U118">j</span>)</span> = <span class="mxinfo " id="T1:U85">(<span class="mxinfo " id="T1:U86"><span class="mxinfo " id="T1:U87">sum(<span class="mxinfo " id="T9:U88">sum(<span class="mxinfo " id="T6:U89"><span class="var type1" id="S3T6U127">I</span>(<span class="mxinfo " id="T14:U91"><span class="mxinfo " id="T1:U92"><span class="var type1" id="S17T1U130">i</span>-<span class="var type1" id="S4T1U131">d</span></span>:<span class="mxinfo " id="T1:U95"><span class="var type1" id="S17T1U133">i</span>+<span class="var type1" id="S4T1U134">d</span></span></span>,<span class="mxinfo " id="T14:U98"><span class="mxinfo " id="T1:U99"><span class="var type1" id="S18T1U137">j</span>-<span class="var type1" id="S4T1U138">d</span></span>:<span class="mxinfo " id="T1:U102"><span class="var type1" id="S18T1U140">j</span>+<span class="var type1" id="S4T1U141">d</span></span></span>)</span>)</span>)</span>- <span class="mxinfo " id="T1:U105"><span class="var type1" id="S3T6U143">I</span>(<span class="var type1" id="S17T1U144">i</span>,<span class="var type1" id="S18T1U145">j</span>)</span></span>)/(<span class="mxinfo " id="T1:U109"><span class="var type1" id="S5T1U148">W</span>-<span class="mxinfo " id="T1:U111">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line"><span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo " id="T6:U112"><span class="var type1" id="S20T6U152">I2</span> = <span class="mxinfo " id="T6:U114"><span class="mxinfo " id="T6:U115">ones(<span class="var type1" id="S6T1U156">h</span>,<span class="var type1" id="S7T1U157">w</span>)</span>.*<span class="mxinfo " id="T1:U118">256</span></span></span>; <span class="comment">% insert outside the region of interest values that are not to be found inside the interest region</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T6:U119"><span class="mxinfo " id="T6:U120"><span class="var type1" id="S20T6U162">I2</span>(<span class="mxinfo " id="T14:U122"><span class="mxinfo " id="T1:U123"><span class="var type1" id="S4T1U165">d</span>+<span class="mxinfo " id="T1:U125">1</span></span>:<span class="mxinfo " id="T1:U126"><span class="var type1" id="S6T1U168">h</span>-<span class="var type1" id="S4T1U169">d</span></span></span>,<span class="mxinfo " id="T14:U129"><span class="mxinfo " id="T1:U130"><span class="var type1" id="S4T1U172">d</span>+<span class="mxinfo " id="T1:U132">1</span></span>:<span class="mxinfo " id="T1:U133"><span class="var type1" id="S7T1U175">w</span>-<span class="var type1" id="S4T1U176">d</span></span></span>)</span>= <span class="mxinfo " id="T6:U136"><span class="var type1" id="S3T6U178">I</span>(<span class="mxinfo " id="T14:U138"><span class="mxinfo " id="T1:U139"><span class="var type1" id="S4T1U181">d</span>+<span class="mxinfo " id="T1:U141">1</span></span>:<span class="mxinfo " id="T1:U142"><span class="var type1" id="S6T1U184">h</span>-<span class="var type1" id="S4T1U185">d</span></span></span>,<span class="mxinfo " id="T14:U145"><span class="mxinfo " id="T1:U146"><span class="var type1" id="S4T1U188">d</span>+<span class="mxinfo " id="T1:U148">1</span></span>:<span class="mxinfo " id="T1:U149"><span class="var type1" id="S7T1U191">w</span>-<span class="var type1" id="S4T1U192">d</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T1:U152"><span class="var type1" id="S22T1U195">c</span>=<span class="mxinfo " id="T1:U154">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S23T1U199">k</span>=<span class="mxinfo " id="T1:U156">0</span>:<span class="var type1" id="S12T1U202">max_value</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line">    [<span class="mxinfo " id="T26:U158"><span class="var type1" id="S24T26U206">row</span></span>,<span class="mxinfo " id="T26:U160"><span class="var type1" id="S25T26U207">col</span></span>] = find(<span class="mxinfo " id="T19:U162"><span class="var type1" id="S20T6U211">I2</span>==<span class="var type1" id="S23T1U212">k</span></span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line">    <span class="mxinfo " id="T1:U165"><span class="mxinfo " id="T1:U166"><span class="var type1" id="S16T26U216">p</span>(<span class="var type1" id="S22T1U217">c</span>)</span> = <span class="mxinfo " id="T1:U169"><span class="mxinfo " id="T1:U170">numel(<span class="var type1" id="S25T26U221">col</span>)</span>/<span class="var type1" id="S11T1U222">n_squared</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T2:U173">isempty(<span class="var type1" id="S25T26U227">col</span>)</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line">        <span class="mxinfo " id="T1:U175"><span class="mxinfo " id="T1:U176"><span class="var type1" id="S15T26U231">s_i</span>(<span class="var type1" id="S22T1U232">c</span>)</span> = <span class="mxinfo " id="T1:U179">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S17T1U237">i</span>=<span class="mxinfo " id="T1:U181">1</span>:<span class="mxinfo " id="T1:U182">length(<span class="var type1" id="S25T26U242">col</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line">            <span class="mxinfo " id="T1:U184"><span class="mxinfo " id="T1:U185"><span class="var type1" id="S15T26U246">s_i</span>(<span class="var type1" id="S22T1U247">c</span>)</span> = <span class="mxinfo " id="T1:U188"><span class="mxinfo " id="T1:U189"><span class="var type1" id="S15T26U250">s_i</span>(<span class="var type1" id="S22T1U251">c</span>)</span> + <span class="mxinfo " id="T1:U192">abs(<span class="mxinfo " id="T1:U193">double(<span class="mxinfo " id="T1:U194"><span class="var type1" id="S3T6U258">I</span>(<span class="mxinfo " id="T1:U196"><span class="var type1" id="S24T26U260">row</span>(<span class="var type1" id="S17T1U261">i</span>)</span>,<span class="mxinfo " id="T1:U199"><span class="var type1" id="S25T26U263">col</span>(<span class="var type1" id="S17T1U264">i</span>)</span>)</span>) - <span class="mxinfo " id="T1:U202"><span class="var type1" id="S9T6U266">A_i</span>(<span class="mxinfo " id="T1:U204"><span class="var type1" id="S24T26U268">row</span>(<span class="var type1" id="S17T1U269">i</span>)</span>,<span class="mxinfo " id="T1:U207"><span class="var type1" id="S25T26U271">col</span>(<span class="var type1" id="S17T1U272">i</span>)</span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line">    <span class="mxinfo " id="T1:U210"><span class="var type1" id="S22T1U275">c</span> = <span class="mxinfo " id="T1:U212"><span class="var type1" id="S22T1U277">c</span> + <span class="mxinfo " id="T1:U214">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo " id="T1:U215"><span class="var type1" id="S2T1U281">Fcomplexity</span> = <span class="mxinfo " id="T1:U217">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36">36</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S17T1U285">i</span>=<span class="mxinfo " id="T1:U219">0</span>:<span class="var type1" id="S12T1U288">max_value</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37">37</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S18T1U291">j</span>=<span class="mxinfo " id="T1:U222">0</span>:<span class="var type1" id="S12T1U294">max_value</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38">38</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T2:U224"><span class="mxinfo " id="T1:U225"><span class="var type1" id="S16T26U300">p</span>(<span class="mxinfo " id="T1:U227"><span class="var type1" id="S17T1U302">i</span>+<span class="mxinfo " id="T1:U229">1</span></span>)</span> ~= <span class="mxinfo " id="T1:U230">0</span></span> &amp;&amp; <span class="mxinfo " id="T2:U231"><span class="mxinfo " id="T1:U232"><span class="var type1" id="S16T26U307">p</span>(<span class="mxinfo " id="T1:U234"><span class="var type1" id="S18T1U309">j</span>+<span class="mxinfo " id="T1:U236">1</span></span>)</span> ~= <span class="mxinfo " id="T1:U237">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39">39</a></span><span class="line">            <span class="mxinfo " id="T1:U238"><span class="var type1" id="S2T1U314">Fcomplexity</span> = <span class="mxinfo " id="T1:U240"><span class="var type1" id="S2T1U316">Fcomplexity</span> + <span class="mxinfo " id="T1:U242"><span class="mxinfo " id="T1:U243"><span class="mxinfo " id="T1:U244">abs(<span class="mxinfo " id="T1:U245"><span class="var type1" id="S17T1U322">i</span>-<span class="var type1" id="S18T1U323">j</span></span>)</span>*(<span class="mxinfo " id="T1:U248"><span class="mxinfo " id="T1:U249"><span class="mxinfo " id="T1:U250"><span class="var type1" id="S16T26U328">p</span>(<span class="mxinfo " id="T1:U252"><span class="var type1" id="S17T1U330">i</span>+<span class="mxinfo " id="T1:U254">1</span></span>)</span>*<span class="mxinfo " id="T1:U255"><span class="var type1" id="S15T26U333">s_i</span>(<span class="mxinfo " id="T1:U257"><span class="var type1" id="S17T1U335">i</span>+<span class="mxinfo " id="T1:U259">1</span></span>)</span></span>+<span class="mxinfo " id="T1:U260"><span class="mxinfo " id="T1:U261"><span class="var type1" id="S16T26U339">p</span>(<span class="mxinfo " id="T1:U263"><span class="var type1" id="S18T1U341">j</span>+<span class="mxinfo " id="T1:U265">1</span></span>)</span>*<span class="mxinfo " id="T1:U266"><span class="var type1" id="S15T26U344">s_i</span>(<span class="mxinfo " id="T1:U268"><span class="var type1" id="S18T1U346">j</span>+<span class="mxinfo " id="T1:U270">1</span></span>)</span></span></span>)</span>/(<span class="mxinfo " id="T1:U271"><span class="mxinfo " id="T1:U272"><span class="var type1" id="S11T1U351">n_squared</span>*(<span class="mxinfo " id="T1:U274"><span class="mxinfo " id="T1:U275"><span class="var type1" id="S16T26U355">p</span>(<span class="mxinfo " id="T1:U277"><span class="var type1" id="S17T1U357">i</span>+<span class="mxinfo " id="T1:U279">1</span></span>)</span>+<span class="mxinfo " id="T1:U280"><span class="var type1" id="S16T26U360">p</span>(<span class="mxinfo " id="T1:U282"><span class="var type1" id="S18T1U362">j</span>+<span class="mxinfo " id="T1:U284">1</span></span>)</span></span>)</span>+<span class="mxinfo " id="T1:U285">realmin</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40">40</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41">41</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42">42</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43">43</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44">44</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45">45</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46">46</a></span><span class="line">    </span></span>
</pre>
